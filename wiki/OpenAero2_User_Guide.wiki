=The OpenAero2 User Guide=
==What is OpenAero2?==
OpenAero is an aeroplane stabilising software for the KK2 multicopter board. You put the programmed KK board in between your receiver and the servos in your aircraft. When deactivated, OpenAero2 just passes the servo signals from your receiver to the servos. When activated, the gyros on your KK board are used to move the servos to counteract any unwanted movement of the aircraft.

==What models can OpenAero2 be used with?==
OpenAero2 have a completely flexible mixer which allows it to control just about anything, but comes with two preset mix tables.

===Aeroplane===
In aeroplane mode there are four stabilised outputs - Left Aileron, Right aileron, Elevator and Rudder.
For those needing a throttle control, you can just take the throttle output of your receiver directly to the ESC for your motor.

In CPPM mode there are five stabilised outputs - Left Aileron, Right aileron, Elevator and Rudder, plus a copy of the throttle signal from the receiver on M1.

Read more about the differences between PWM and CPPM receivers elsewhere in this Wiki.

===Flying Wing===
Flying wings normally have delta/flaperon mixing done by the transmitter. This allows you to set the aileron/elevator mixing as best suits you and your aircraft.
When these signals pass through the OpenAero2 software the gyro stabilising has to accommodate the flying wing channel mixing. 
For instance, in response to pitch input, the standard version of Openaero2 would simply adjust the elevator servo. However the flying wing version adjusts both flaperons to have the desired effect.

In flying wing mode there are three stabilised outputs - Left Flaperon, Right Flaperon and Rudder.

For those needing a throttle control, you can just take the throttle output of your receiver directly to the ESC for your motor. 

In CPPM mode there are four stabilised outputs - Left Flaperon, Right Flaperon and Rudder, and a copy of the throttle signal from the receiver on M1.

==How do I connect up my model?==
*A note about servo connections*
There is no +5V power supplied to M2 to M8, so you must supply your own 5V to any of M2 to M8 via a BESC or battery pack.

===Receiver connections===
For a standard multi-wire PWM receiver you need to use the normal PWM inputs of the KK board. However, the THR input of the KK board has been repurposed to be the secondary aileron input.

If you have a CPPM receiver, connect the single wire to the RUDDER input. Also, don't forget to enable CPPM mode in the RC Setup menu.

 * AIL: Aileron signal input (required)
 * ELE: Elevator signal input (required)
 * THR: Second aileron signal input (optional)
 * RUD: Rudder signal input (optional) CPPM input
 * AUX: Stability switch input (required)

Please make careful note that for OpenAero2 to output servo signals, at least two inputs, including the stability switch input *MUST* be connected to the KK2 board.

Using the OpenAero2 menus, you can set up how you wish to control stability and autolevel. This will be discussed later in the guide.

Here is a diagram showing how to connect up a PWM receiver.
http://i.imgur.com/S2xRY.jpg

===CPPM channel order===
CPPM mode requires that the receiver and a transmitter can reallocate channels if not matching the JR/Spektrum or Futaba channel order.
OpenAero2 supports JR/Spektrum and Futaba CPPM channel order as shown below.

*JR/Spektrum*
 * CH1: Throttle
 * CH2: Aileron #1
 * CH3: Elevator
 * CH4: Rudder
 * CH5: Gear switch
 * CH6: Aileron #2
 * CH7: Aux 1
 * CH8: Aux 2 
*Futaba*
 * CH1: Aileron #1
 * CH2: Elevator
 * CH3: Throttle
 * CH4: Rudder
 * CH5: Gear switch
 * CH6: Aileron #2
 * CH7: Aux 1
 * CH8: Aux 2 

===Servo connections===
For conventional aeroplanes the connections are as follows:
 * M1: Throttle (CPPM only)
 * M2: Free channel or Pitch/Tilt for camera stabilising (TBA)
 * M3: Free channel or Yaw/Pan for camera stabilising (TBA)
 * M4: Free channel or Roll for camera stabilising (TBA)
 * M5: Elevator
 * M6: Left aileron
 * M7: Right aileron
 * M8: Rudder

For flying wing models the connections are as follows:
 * M1: Throttle (CPPM only)
 * M2: Free channel or Pitch/Tilt for camera stabilising (TBA)
 * M3: Free channel or Yaw/Pan for camera stabilising (TBA)
 * M4: Free channel or Roll for camera stabilising (TBA)
 * M5: Elevator
 * M6: Left elevon
 * M7: Right elevon
 * M8: Rudder

==How do I set up OpenAero?==
===Stability and Autolevel switching===
Due to countless requests you now have absolute freedom in how to enable these modes.
In the Stability and Autolevel Settings menus you can select which method of control you wish to use.

 * OFF: Always off
 * Autochan: On when the channel set as "Autochan" in RC settings is more than 50%
 * Stabchan: On when the channel set as "Stabchan" in RC settings is more than 50%
 * 3-pos: Stability on when the channel set as "3-pos" in RC settings is more than 33%. Autolevel also on when the channel set as 3-pos in RC settings is more than 66%
 * ON: Always on

*3-pos switch*
The three-position switch mode allows you to have both Stability and Autolevel on one switch, but have them selectable.
The way it works is this:
For the switch position between minimum and about 33% = Stability off, Autolevel off.
For the switch position between 33% and about 66% = Stability on, Autolevel off.
For the switch position above 66% = Stability on, Autolevel on.

*RC Setting defaults*
Stabchan = GEAR (normally ch.5)
Autochan = AUX1 (normally ch.7)
Flapchan = FLAP (normally ch.6)
3-pos chan = disabled

===The LCD Menu System===
*Main menu*
The main menu stops the loop. The main menu controls should be self-explanatory.
LEFT exits to the status menu
RIGHT goes down into a submenu
UD/DOWN moves through the menu list

*Sub menus*
LEFT exits to the main menu
RIGHT open up an item to edit
UD/DOWN moves through the sub menu list

*Menu item*
LEFT resets the item to its minimum value
RIGHT saves the item
UD/DOWN increments and decrements the item

*Contrast*
You can change the screen contrast inside the General menu.

===Initial setup and calibration===
The first time you set up OpenAero you will have to adjust a few things to suit your radio gear and particular usage. 

*Step 1: Model type*
Go into the General menu and change the Mode to that which suits your model. The default is Aeroplane.

*Step 2: RC settings*
 * Set the Rx mode to suit your radio. Unless you are using CPPM, start with PWM1. CPPM users select CPPM.
 * If you are using CPPM, also select the channel order between either JR/Spektrum or Futaba.
 * Select which input channel you plan to use for stability. PWM users will normally select the fifth channel (GEAR) as that corresponds to the fifth (AUX) input on the KK2. CPPM users can pick any unused channel.
 * Select which input channel you plan to use for autolevel. PWM users may select the unused throttle input (THROTTLE) or double-up the two functions on the fifth channel (GEAR). CPPM users can pick any unused channel.
 * If you have a three-position switch and plan to use it, set the channel it is on here.
 * If your radio carries the second aileron channel on a channel different to the default of FLAP (channel 6) set that here too.
*Step 3: Stability settings*
 * For now, just alter the Mode as described above in "Stability and Autolevel switching".
*Step 4: Autolevel settings*
 * For now, just alter the Mode as described above in "Stability and Autolevel switching".
*Step 5: RC check*
 * Go to the RC Inputs screen and switch on your transmitter and receiver. You should 


*Setting failsafe mode (V1.13 and above)*

To setup failsafe mode, set the control positions that you require, then simply short the M6 signal pin to ground. An RX bind plug linking the two opposite end pins is perfect for this job. M6 needs to be shorted for one second to trigger failsafe learning mode. 
In failsafe learning mode the LED will start to flash. You can then remove the shorting jumper to stop the learning mode from restarting. When the LED has stopped flashing the failsafe has been set.

*Trimming your model*

For OpenAero to understand the normal trimmed radio settings, you have to ask it to learn the trimmed position.
Firstly though, your model has to be completely trimmed when OpenAero stability is OFF.
To be sure OpenAero stability is off, with the model powered up, move the model about and see if the control surfaces move. If so, stability is ON and you have to correct that before proceeding. Change the input that controls stability to the opposite state to switch off stability.
Now adjust all flying surfaces to the neutral position with all trims centered. Please adjust the mechanical servo connections and finally the computer-controlled trims in the transmitter until the model is trimmed.

*Stick centering*

To get OpenAero to learn the neutral stick position, all you have to do is power up the model (with transmitter on) while the Yaw pot is set to the correct position. 
Different boards have the pot polarity reversed so there is no hard rule to determine which direction (clockwise or couter-clockwise) to turn the yaw pot.
What we need to do is set the Yaw pot to the minimum value. Turn the pot with a small screwdriver until it hits the stop in the minimum direction.
Power up the model and watch the LED on the KK board carefully.
If the Yaw pot is set to the correct position, the LED should blink rapidly three times then one long flash. If so the stick position has been successfully saved.
If the Yaw pot is set to the wrong position, the LED will blink about 12-13 times. Power off the model, reverse the Yaw pot and try again.
Once the stick position has been successfully saved, switch off and please remember to return the Yaw pot to the center of its travel.

*Checking the gyro direction*

An extremely important step is to confirm that the gyros are acting on your model as appropriate. If the gyro directions are reversed any motion of the model will be amplified in the same direction leading to an almost immediate crash.
Once you have the model trimmed correctly, switch on stabilisation and watch carefully how the control surfces move in response to moving the model.

Gyros respond to rotation, so the easiest way to check the gyro direction is to rotate the model on each axis one by one.
With the model held in front of you, rotate it along the roll axis and watch the ailerons move. They should move to oppose the movement. For example the falling wing's aileron should move DOWN and the rising wing's aileron should move UP. If this is not the case, the Roll gyro needs to be reversed.

With the model held in front of you, rotate it up and down along the pitch axis and watch the elevator move. It should move to oppose the movement. For example the elevator should move DOWN when you pitch the model's nose UP and DOWN when you pitch the model's nose UP. If this is not the case, the Pitch gyro needs to be reversed.

With the model held in front of you, rotate it left and right along the yaw axis and watch the rudder move. It should move to oppose the movement. For example the rudder should move LEFT when you yaw the model's nose RIGHT and RIGHT when you yaw the model's nose LEFT. If this is not the case, the Yaw gyro needs to be reversed.

*Adjusting the gyro direction*

To get OpenAero to change gyro direction, all you have to do is power up the model while the Roll pot is set to the correct position. 
Different boards have the pot polarity reversed so there is no hard rule to determine which direction (clockwise or couter-clockwise) to turn the Roll pot.
What we need to do is set the Roll pot to the minimum value. Turn the pot with a small screwdriver until it hits the stop in the minimum direction.
Power up the model and watch the LED on the KK board carefully.
If the Roll pot is set to the correct position, the LED should blink rapidly *six* times, then stay ON. If so, we are in gyro reversing mode.

 * Move the transmitter roll stick left or right to set the roll gyro to the normal or reversed state. The LED on the KK board will flash briefly to indicate that the setting has changed.
 * Move the transmitter yaw stick left or right to set the yaw gyro to the normal or reversed state. The LED on the KK board will flash briefly to indicate that the setting has changed.
 * Move the transmitter pitch stick up or down to set the pitch gyro to the normal or reversed state. The LED on the KK board will flash briefly to indicate that the setting has changed.

Once the gyro direction has been successfully saved, switch off and please remember to return the Roll pot back to your preferred setting.

If you find that the gyro direction has not changed, try moving the transmitter stick in the *opposite* direction next time.


===Every time you power up OpenAero===
There are some important things to note when starting OpenAero.

*Stick positions*

The stick positions that the transmitter is in as the model powers up are important to OpenAero. Unless you plan to alter the stability switch modes, make sure the transmitter sticks are centered while powering up your model.

*Gyro calibration*

The gyros are calibrated automatically when the model is powered up.
It is important that the model is held very still while the gyro calibration is taking place.

To make this easier, the gyro calibration is done after a short pause and just as the LED lights on the KK board. This allows two seconds or so to connect the battery and allow any movement to settle.


*Safety*

Always make sure your throttle is set to minimum before attempting to power up your model. *Warning:* Even with the transmitter throttle set to zero, there may be a momentary output from the KK board to the throttle channel which may cause the motor to turn very briefly. As such stay well away from the motor and propellor and sure your model when powering it up.

==Flying with OpenAero==
Once you have confirmed that the gyro direction is correct you are ready to fly with OpenAero. Do initial test flights with stability switched OFF until you are sure that your model is aerodynamically trimmed and the control throws are set appropriately.
You can then, at a safe height, switch on stability and carefully observe the model.
You may find that the controls appear more sluggish than normal as the software dampens movement of the model.


=Donations=
OpenAero is a open-source project and is free, however it is also the result of many hundreds of hours of hard work.
If you feel motivated to donate to the project please feel free. I'm always happy to make special versions for people.

http://i.imgur.com/uaRIu.png

Yeah Google Code sucks and the button won't work. You can find a working button on the OpenAero Project page at the following link.
https://sites.google.com/site/openaerowiki/home
=The OpenAero2 User Guide= (Work in progress)
==What is OpenAero2?==
OpenAero2 is an aeroplane stabilising software for the KK2 multicopter board. You put the programmed KK board in between your receiver and the servos in your aircraft. When deactivated, OpenAero2 just passes the servo signals from your receiver to the servos. When activated, the gyros on your KK board are used to move the servos to counteract any unwanted movement of the aircraft.

OpenAero2 has eight output channels which can all mix from five PWM RC channels in PWM mode, and eight RC channels in CPPM mode. In addition, four preset channel sources can be used as inputs.
Each of the eight output channels can have any or all sensors mixed together.

==What models can OpenAero2 be used with?==
OpenAero2 have a completely flexible mixer which allows it to control just about anything, but comes with two preset mix tables.

===Aeroplane===
In aeroplane mode there are four stabilised outputs - Left Aileron, Right aileron, Elevator and Rudder.
For those needing a throttle control, you can just take the throttle output of your receiver directly to the ESC for your motor.

In CPPM mode there are five stabilised outputs - Left Aileron, Right aileron, Elevator and Rudder, plus a copy of the throttle signal from the receiver on M1.

Read more about the differences between PWM and CPPM receivers elsewhere in this Wiki.

===Flying Wing===
Flying wings normally have delta/flaperon mixing done by the transmitter. This allows you to set the aileron/elevator mixing as best suits you and your aircraft.
When these signals pass through the OpenAero2 software the gyro stabilising has to accommodate the flying wing channel mixing. 
For instance, in response to pitch input, the standard version of Openaero2 would simply adjust the elevator servo. However the flying wing version adjusts both flaperons to have the desired effect.

In flying wing mode there are three stabilised outputs - Left Flaperon, Right Flaperon and Rudder.

For those needing a throttle control, you can just take the throttle output of your receiver directly to the ESC for your motor. 

In CPPM mode there are four stabilised outputs - Left Flaperon, Right Flaperon and Rudder, and a copy of the throttle signal from the receiver on M1.

==How do I connect up my model?==
*A note about servo connections*
There is no +5V power supplied to M2 to M8, so you must supply your own 5V to any of M2 to M8 via a BESC or battery pack.

===Receiver connections===
For a standard multi-wire PWM receiver you need to use the normal PWM inputs of the KK board. However, the THR input of the KK board has been repurposed to be the secondary aileron input.

If you have a CPPM receiver, connect the single wire to the RUDDER input. Also, don't forget to enable CPPM mode in the RC Setup menu.

 * AIL: Aileron signal input (required)
 * ELE: Elevator signal input (required)
 * THR: Second aileron signal input (optional)
 * RUD: Rudder signal input (optional) CPPM input
 * AUX: Stability switch input (required)

Please make careful note that for OpenAero2 to output servo signals, at least two inputs, including the stability switch input *MUST* be connected to the KK2 board.

Using the OpenAero2 menus, you can set up how you wish to control stability and autolevel. This will be discussed later in the guide.

Here is a diagram showing how to connect up a PWM receiver.
http://i.imgur.com/S2xRY.jpg

===CPPM channel order===
CPPM mode requires that the receiver and a transmitter can reallocate channels if not matching the JR/Spektrum or Futaba channel order.
OpenAero2 supports JR/Spektrum and Futaba CPPM channel order as shown below.

*JR/Spektrum*
 * CH1: Throttle
 * CH2: Aileron #1
 * CH3: Elevator
 * CH4: Rudder
 * CH5: Gear switch
 * CH6: Aileron #2
 * CH7: Aux 1
 * CH8: Aux 2 
*Futaba*
 * CH1: Aileron #1
 * CH2: Elevator
 * CH3: Throttle
 * CH4: Rudder
 * CH5: Gear switch
 * CH6: Aileron #2
 * CH7: Aux 1
 * CH8: Aux 2 

===Servo connections===
For conventional aeroplanes the connections are as follows:
 * M1: Throttle (CPPM only)
 * M2: Free channel or Pitch/Tilt for camera stabilising (TBA)
 * M3: Free channel or Yaw/Pan for camera stabilising (TBA)
 * M4: Free channel or Roll for camera stabilising (TBA)
 * M5: Elevator
 * M6: Left aileron
 * M7: Right aileron
 * M8: Rudder

For flying wing models the connections are as follows:
 * M1: Throttle (CPPM only)
 * M2: Free channel or Pitch/Tilt for camera stabilising (TBA)
 * M3: Free channel or Yaw/Pan for camera stabilising (TBA)
 * M4: Free channel or Roll for camera stabilising (TBA)
 * M5: Elevator
 * M6: Left elevon
 * M7: Right elevon
 * M8: Rudder

==How do I set up OpenAero2?==
===Stability and Autolevel switching===
Due to countless requests you now have absolute freedom in how to enable these modes.
In the Stability and Autolevel Settings menus you can select which method of control you wish to use.

 * OFF: Always off
 * Autochan: On when the channel set as "Autochan" in RC settings is more than 50%
 * Stabchan: On when the channel set as "Stabchan" in RC settings is more than 50%
 * 3-pos: Stability on when the channel set as "3-pos" in RC settings is more than 33%. Autolevel also on when the channel set as 3-pos in RC settings is more than 66%
 * ON: Always on

*3-pos switch*
The three-position switch mode allows you to have both Stability and Autolevel on one switch, but have them selectable.
The way it works is this:
For the switch position between minimum and about 33% = Stability off, Autolevel off.
For the switch position between 33% and about 66% = Stability on, Autolevel off.
For the switch position above 66% = Stability on, Autolevel on.

*RC Setting defaults*
Stabchan = GEAR (normally ch.5)
Autochan = AUX1 (normally ch.7)
Flapchan = FLAP (normally ch.6)
3-pos chan = disabled

===The LCD Menu System===
*Main menu*
The main menu stops the loop. The main menu controls should be self-explanatory.
LEFT exits to the status menu
RIGHT goes down into a submenu
UD/DOWN moves through the menu list

*Sub menus*
LEFT exits to the main menu
RIGHT open up an item to edit
UD/DOWN moves through the sub menu list

*Menu item*
LEFT resets the item to its minimum value
RIGHT saves the item
UD/DOWN increments and decrements the item

*Contrast*
You can change the screen contrast inside the General menu.
==The Status Screen==
The status screen gives you a continually updated display of the battery status, flight modes and any error messages.

http://i.imgur.com/kaaAF.jpg

*Mode:* The current mixer mode

*Version:* The version number of the loaded firmware

*Input:* The RC input mode (CPPM/PWM1, PWM2 or PWM3)

*Autolevel:* The current autolevel status (ON/OFF)


*Stability:* The current stability status (ON/OFF)

The menu defaults to auto-update, which means the menu self-refreshes every two second when no RC activity is detected. The screen will not update if there is RC activity.

If the auto-update is switched off, the screen can be manually updated with the "Refresh" button (button 1).

Pressing button 3 goes to the main menu.

==Error messages==
If an error or alarm is detected the buzzer will sound and a message will be displayed on the screen. There are five possible screen messages.
http://i.imgur.com/bnM8R.jpg
http://i.imgur.com/MEX6v.jpg
http://i.imgur.com/zz3pz.jpg

*Sensor Error:* 
When the board is powered up it must remain still so that the gyros can be accurately calibrated. It the boards detects movement during calibration, this error will be displayed. To clear this error, repower the board while keeping the board still.

*Battery Low:*
If you are using the board to monitor the battery voltage, when the current battery voltage falls below the set alarm point, this message is shown. 
If you are not planning to monitor the battery voltage, please set the LVA to zero.

*No Signal:*
This message will be displayed when the board detects a loss of RC signal.

http://i.imgur.com/Oynh2.jpg
http://i.imgur.com/v397I.jpg

*Lost Model:*
Approximately one minute after the last detected RC input, the Lost Model buzzer will sound and this message will be displayed. The alarm can be cancelled with any stick input.

*Throttle High:*
PWM does not require a throttle input in OpenAero2. In CPPM mode however, the throttle signal is passed through the board and appears as a PWM signal on M1.
As a safety measure, if the board is powered up with the throttle set to more than about 5%, the oupts will be disabled, anaalarm will sound and this message will be displayed.

==Initial setup and calibration==
The first time you set up OpenAero2 you will have to adjust a few things to suit your radio gear and particular usage. 

*Step 1: Model type*
Go into the General menu and change the Mode to that which suits your model. The default is Aeroplane.

*Step 2: RC settings*
 * Set the Rx mode to suit your radio. Unless you are using CPPM, start with PWM1. CPPM users select CPPM.
 * If you are using CPPM, also select the channel order between either JR/Spektrum or Futaba.
 * Select which input channel you plan to use for stability. PWM users will normally select the fifth channel (GEAR) as that corresponds to the fifth (AUX) input on the KK2. CPPM users can pick any unused channel.
 * Select which input channel you plan to use for autolevel. PWM users may select the unused throttle input (THROTTLE) or double-up the two functions on the fifth channel (GEAR). CPPM users can pick any unused channel.
 * If you have a three-position switch and plan to use it, set the channel it is on here.
 * If your radio carries the second aileron channel on a channel different to the default of FLAP (channel 6) set that here too.
*Step 3: Stability settings*
 * For now, just alter the Mode as described above in "Stability and Autolevel switching".
*Step 4: Autolevel settings*
 * For now, just alter the Mode as described above in "Stability and Autolevel switching".
*Step 5: RC check*
 * Go to the RC Inputs screen and switch on your transmitter and receiver. You should immediately see values appearing in both columns next to each connected channel.
 * Make sure all the tranmitter channels are centered and the throttle to minimum, and press button 4, under the screen label "Cal." This performs a stick centering calibration.
 * The right-hand column should now all be zero and change +/-1000 or so at the extremes of throw.

*Step 6: Servo direction*

One return to the status menu, the servos should be activated and you should be able to control all outputs with the transmitter. Please make sure that stability and autolevel are both OFF to continue. Their status can easily be seen in the status menu.

 * Move all surfaces and check that the move as expected. While you can reverse the channels in the M1 to M8 mixers, it is best to reverse them in the transmitter first.

*Step 7: Gyro direction*
 * Now, switch on stability control whil leaving autolevel OFF.
 * Pitch the nose of the model up and down while watching the elevator. The elevator should move to counteract the pitching. Pitching the nose UP should make the elevator move DOWN.
 * If this is not the case, you can reverse the pitch gyro in the M5 mixer menu.
 * Roll the model left and right while watching the ailerons. They should also move to counteract the rolling. Use the M6 and M7 mixer menus to reverse the roll gyro as required.
 * Finally, yaw the model left and right while observing the rudder. Adjust the M8 mixer menu to reverse the yaw gyro as required.

*Step 8: Auto-level setup*
 * Firstly, go into the balance meter screen of the menu and observe the balance meter. The black dot indicates where OpenAero2 thinks "down" is.
 * Place the model on a flat surface and chock up the tail or nose until it is level and in its normal flying attitude.
 * Keeping the model perfectly still, carefully press button 4 under the screen marker "Cal." After a short pause the black dot will move to the center of the display.
 * Go back to the status menu.
 * Switch off stability control and switch ON autolevel.
 * Tilt the model in pitch and roll while watching the respective surfaces. They should move slightly to compensate and remain in that position.
 * If they move in the reverse sense, reverse the pitch and roll acc settings in the mixer menus for M5, M6 and M6 as appropriate.


===Every time you power up OpenAero2===
There are some important things to note when starting OpenAero2.

*Gyro calibration*

The gyros are calibrated automatically when the model is powered up.
It is important that the model is held very still while the gyro calibration is taking place.
If you move the model during calibration the "Sensor Error" message will appear with a warning beep. The only option is to repower the board.


*Safety*

Always make sure your throttle is set to minimum before attempting to power up your model. *Warning:* Even with the transmitter throttle set to zero, there may be a momentary output from the KK board to the throttle channel which may cause the motor to turn very briefly. As such stay well away from the motor and propellor and sure your model when powering it up.

=Donations=
OpenAero2 is a open-source project and is free, however it is also the result of many hundreds of hours of hard work.
If you feel motivated to donate to the project please feel free. I'm always happy to make special versions for people.

http://i.imgur.com/uaRIu.png

Yeah Google Code sucks and the button won't work. You can find a working button on the OpenAero2 Project page at the following link.
https://sites.google.com/site/openaerowiki/home